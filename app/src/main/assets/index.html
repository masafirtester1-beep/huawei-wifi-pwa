<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Huawei WiFi Helper</title>
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <h2>معلومات الشبكة</h2>
  <p><b>SSID:</b> <span id="ssid">غير متاح</span></p>
  <p><b>RSSI:</b> <span id="rssi">غير متاح</span></p>

  <button id="permBtn">طلب/تحديث الصلاحيات</button>

  <!-- باقي الواجهة… -->

  <script src="app.js"></script>
  <script>
    // يُستدعى من الأندرويد بعد تحميل الصفحة
    function startAuto() {
      if (window.AppAutoStarted) return; // لا نكرر
      window.AppAutoStarted = true;
      window.App.startAutoRefresh();     // من app.js
    }

    // حتى لو الأندرويد ما ناداش، نبدأ نحن بعد DOMContentLoaded
    document.addEventListener('DOMContentLoaded', () => {
      startAuto();
    });

    // كولباك يستدعيه الأندرويد بعد نتيجة طلب الصلاحيات
    window.onPermissionsUpdated = function(granted) {
      // مباشرة نحدّث القراءة
      if (window.App) window.App.readOnce();
    };

    // زر يدوي إذا بغيتي
    document.getElementById('permBtn').addEventListener('click', () => {
      if (window.Android && Android.askPermissions) Android.askPermissions();
    });
  </script>
</body>
</html>
